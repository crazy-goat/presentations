<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <title>Blazingly Fast Websites with Parallel Composition</title>
    <meta name="description" content="Blazingly Fast Websites with Parallel Composition">
    <meta name="author" content="Piotr Hałas">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/dist/reset.css">
    <link rel="stylesheet" href="/dist/reveal.css">
    <link rel="stylesheet" href="/dist/theme/beige.css"  id="theme">
    <link rel="stylesheet" href="/plugin/highlight/github-light-default.css">
    <link rel="stylesheet" href="assets/history.css">
    <style>
        .highlight-code {
            background-color: white;
            color: #000;
            font-weight: bold;
            font-family: var(--r-code-font);
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section data-auto-animate data-auto-animate-id="intro">
            <h1 class="r-fit-text">Blazingly Fast</h1>
            <aside class="notes">Planowałem tę prezentacje na 30 minut ale wyszło ponad 50 slajwód, więc będę mówił niesamowice szybko. No chyba żę mogę nagiąć trochę czas</aside>
        </section>
        <section data-auto-animate data-auto-animate-id="intro">
            <h1 class="r-fit-text">Blazingly Fast</h1>
            <h3>Websites with Parallel Composition</h3>
            <p>
                <small>Created by <a href="http://hakim.se">Piotr Hałas</a> from
                    <a href="https://github.com/hakimel/reveal.js/graphs/contributors">Crazy Goat Software</a></small>
            </p>
            <aside class="notes"><ul>
                <li>Niesamowicie szybkie strony www korzystające z współbieżnej kompozycji</li>
                <li>Nie szukam pracowników</li></ul> </aside>
        </section>
        <section data-auto-animate data-auto-animate-id="agenda">
            <h1 data-id="chapter_agenda" class="r-fit-text">Agenda</h1>
        </section>
        <section data-auto-animate data-auto-animate-id="agenda">
            <h1 data-id="chapter_agenda">Agenda</h1>
            <ol>
                <li>WHOAMI</li>
                <li class="fragment">What is page composition</li>
                <li class="fragment">Evolution of available technologies</li>
                <li class="fragment">Technology today - where we stand</li>
                <li class="fragment">Live demo <span class="fragment">x2</span><span class="fragment"> - hope it works</span></li>
                <li class="fragment">Looking Ahead: go-mesi project</li>
                <li class="fragment">Q&A</li>
            </ol>
            <aside class="notes">
                Oby był czas na Q&A
            </aside>
        </section>
        <section>
            <h3>WHOAMI --env=dev</h3>
            <ul>
                <li>Professionally coding in PHP since 2007
                    <ul>
                        <li class="fragment">Symfony from version 1.0</li>
                        <li class="fragment">Explored Slim and Zend frameworks.</li>
                        <li class="fragment">Workerman/Webman i (Open)Swoole</li>
                    </ul>
                </li>
                <li class="fragment">Hobby
                    <ul>
                        <li>C/C++ embedded, ESP-01/12, Arduino</li>
                        <li class="fragment">Golang - tooling, PHP + Golang</li>
                    </ul>
                </li>
                <li class="fragment">Small DevOps
                    <span class="fragment"> - CI/CD</span><span class="fragment">, Docker</span><span class="fragment">, Systems Architecture</span>
                </li>
                <li class="fragment">Open Source contributor</li>
                <li class="fragment">Engineering mindset over pure theory</li>
            </ul>
        </section>
        <section>
            <h3>WHOAMI --env=live</h3>
            <ul>
                <li>Proud Husband and Father of Two Daughters</li>
                <li class="fragment">Run a small farm Hałaśliwa Zagroda
                    <ul>
                        <li class="fragment">Farm animals: <span class="fragment">horse, donkeys, goats, sheep, pigs, ducks, geese, chickens,
                            guinea fowl</span><span class="fragment">; domestic: dogs, cats, fish</span></li>
                        <li class="fragment">We produce goat cheese and sell eggs<span
                                class="fragment">, organize school trips</span><span
                                class="fragment">, birthday parties for children</span>
                        </li>
                    </ul>
                </li>
                <li class="fragment">Passion for Woodworking</li>
                <li class="fragment">Enjoy Welding Projects</li>
                <li class="fragment">Love for Classic Vehicles</li>
                <li class="fragment">Youtuber</li>
            </ul>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-1">
            <h1 class="r-fit-text">The first riddle</h1>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-1">
            <h1>The first riddle</h1>
            <h3>Which animal is <span style="color: red">not</span> on our farm?</h3>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-1">
            <h1>The first riddle</h1>
            <h3>Which animal is <span style="color: red">not</span> on our farm?</h3>
            <table>
                <tbody>
                <tr>
                    <td>Horse</td>
                    <td>Duck</td>
                    <td>Dog</td>
                </tr>
                <tr>
                    <td>Cat</td>
                    <td>Goose</td>
                    <td>Goat</td>
                </tr>
                <tr>
                    <td>Donkey</td>
                    <td>Fish</td>
                    <td>Cow</td>
                </tr>
                </tbody>
            </table>
            <span style="display: none" data-id="answer-1">Cow</span>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-1">
            <h1 class="r-fit-text"><span data-id="answer-1">Cow</span></h1>
        </section>
        <section>
            <h1 class="r-fit-text">Page composition?</h1>
        </section>
        <section>
            <h2>Page composition?</h2>
            <p>Page composition is now primarily associated with web development, referring to the process of assembling
                a webpage from multiple independent components. This approach allows for better modularity, scalability,
                and performance optimization.</p>
        </section>
        <section>
            <h3>Page composition - web example</h3>
            <img class="r-fit-text" src="assets/page-layout.png">
            <small>https://webstyleguide.com/wsg3/6-page-structure/3-site-design.html</small>
        </section>
        <section>
            <h2>Page composition</h2>
            <p>
                Page composition in reality, it is an old concept that has been used for centuries in:
            </p>
            <ul>
                <li class="fragment"><strong>Books & Newspapers</strong> – Consistent layout with fixed sections
                    like
                    headers, footers, and sidebars.
                </li>
                <li class="fragment"><strong>Business Letterheads</strong> – Predefined structure with repeating
                    elements (e.g., company logo, recipient details, footer).
                </li>
                <li class="fragment"><strong>Invoices</strong> - Structured format with recurring elements like
                    company details, recipient information, and itemized lists.
                </li>
            </ul>
        </section>
        <section>
            <h3>Page composition - books</h3>
            <img class="stretch r-fit-text" src="assets/old_book.png">
        </section>
        <section>
            <h3>Page composition - business letterhead</h3>
            <img class="stretch r-fit-text" src="assets/business_letterhead.png">
        </section>
        <section>
            <h3>Page composition - invoice</h3>
            <img class="stretch" src="assets/invoice.png">
        </section>
        <section>
            <h1 class="r-fit-text">History Overview</h1>
        </section>
        <section data-transition="slide-in none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                    </td>
                    <td class="orange">
                    </td>
                    <td class="red">
                    </td>
                    <td class="purple">
                    </td>
                    <td class="blue">
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                </tr>
            </table>
            <aside class="notes">Jedyna opcja to pisanie własnego serwera www. Więc raczej nie było dynamicznych stron</aside>
        </section>
        <section data-transition="none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-green">1993</div>
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                        <div class="dot"></div>
                    </td>
                    <td class="orange">
                    </td>
                    <td class="red">
                    </td>
                    <td class="purple">
                    </td>
                    <td class="blue">
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle green"><img src="assets/history/ssi.png">
                        </div>
                        <p class="description">CGI/SSI</p>
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                </tr>
            </table>
            <aside class="notes"><ul>
                <li>CGI - Możliwość uruchamiania kodu np: liczniki.</li>
                <li>SSI - Możliwość załączenia fragmentu html z innego pliku</li>
            </ul></aside>
        </section>
        <section data-transition="none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-green">1993</div>
                    </td>
                    <td class="bottom">
                        <p class="description">iFrame</p>
                        <div class="icon-circle orange"><img src="assets/history/iframe.png">
                        </div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                        <div class="dot"></div>
                    </td>
                    <td class="orange">
                        <div class="dot"></div>
                    </td>
                    <td class="red">
                    </td>
                    <td class="purple">
                    </td>
                    <td class="blue">
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle green"><img src="assets/history/ssi.png">
                        </div>
                        <p class="description">CGI/SSI</p>
                    </td>
                    <td class="top">
                        <div class="year text-orange">1997</div>
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                </tr>
            </table>
            <aside class="notes">Znienawidzony iframe, po raz pierwszy pojawia się możliwość kompozycji na froncie</aside>
        </section>
        <section data-transition="none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-green">1993</div>
                    </td>
                    <td class="bottom">
                        <p class="description">iFrame</p>
                        <div class="icon-circle orange"><img src="assets/history/iframe.png">
                        </div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-red">1999</div>
                    </td>
                    <td class="bottom">
                    </td>
                    <td class="bottom">
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                        <div class="dot"></div>
                    </td>
                    <td class="orange">
                        <div class="dot"></div>
                    </td>
                    <td class="red">
                        <div class="dot"></div>
                    </td>
                    <td class="purple">
                    </td>
                    <td class="blue">
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle green"><img src="assets/history/ssi.png">
                        </div>
                        <p class="description">CGI/SSI</p>
                    </td>
                    <td class="top">
                        <div class="year text-orange">1997</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle red"><img src="assets/history/ajax.png"></div>
                        <p class="description">XMLHttpRequest</p>
                    </td>
                    <td class="top">
                    </td>
                    <td class="top">
                    </td>
                </tr>
            </table>
            <aside class="notes">Protoplasta AJAX - wkońcu mamy możliwość częśćiowej aktualizacji zawartości strony</aside>
        </section>
        <section data-transition="none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-green">1993</div>
                    </td>
                    <td class="bottom">
                        <p class="description">iFrame</p>
                        <div class="icon-circle orange"><img src="assets/history/iframe.png">
                        </div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-red">1999</div>
                    </td>
                    <td class="bottom">
                        <p class="description">ESI</p>
                        <div class="icon-circle purple"><img src="assets/history/esi.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                        <div class="dot"></div>
                    </td>
                    <td class="orange">
                        <div class="dot"></div>
                    </td>
                    <td class="red">
                        <div class="dot"></div>
                    </td>
                    <td class="purple">
                        <div class="dot"></div>
                    </td>
                    <td class="blue">
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle green"><img src="assets/history/ssi.png">
                        </div>
                        <p class="description">CGI/SSI</p>
                    </td>
                    <td class="top">
                        <div class="year text-orange">1997</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle red"><img src="assets/history/ajax.png"></div>
                        <p class="description">XMLHttpRequest</p>
                    </td>
                    <td class="top">
                        <div class="year text-purple">2001</div>
                    </td>
                    <td class="top">
                    </td>
                </tr>
            </table>
            <aside class="notes">Wraz z pojawieniem się CDN mamy możliwość kompozycji stron blisko klienta</aside>
        </section>
        <section data-transition="none">
            <h3> History Overview</h3>
            <table class="main-table" style="font-size: 0.7em; table-layout: fixed">
                <tr>
                    <td class="bottom">
                        <p class="description">Dark ages</p>
                        <div class="icon-circle teal"><img src="assets/history/dragon.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-green">1993</div>
                    </td>
                    <td class="bottom">
                        <p class="description">iFrame</p>
                        <div class="icon-circle orange"><img src="assets/history/iframe.png">
                        </div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-red">1999</div>
                    </td>
                    <td class="bottom">
                        <p class="description">ESI</p>
                        <div class="icon-circle purple"><img src="assets/history/esi.png"></div>
                        <div class="connector"></div>
                    </td>
                    <td class="bottom">
                        <div class="year text-blue">2010</div>
                    </td>
                </tr>
                <tr>
                    <td class="teal">
                        <div class="dot"></div>
                    </td>
                    <td class="green">
                        <div class="dot"></div>
                    </td>
                    <td class="orange">
                        <div class="dot"></div>
                    </td>
                    <td class="red">
                        <div class="dot"></div>
                    </td>
                    <td class="purple">
                        <div class="dot"></div>
                    </td>
                    <td class="blue">
                        <div class="dot"></div>
                    </td>
                </tr>
                <tr>
                    <td class="top">
                        <div class="year text-teal">&lt;1993</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle green"><img src="assets/history/ssi.png">
                        </div>
                        <p class="description">CGI/SSI</p>
                    </td>
                    <td class="top">
                        <div class="year text-orange">1997</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle red"><img src="assets/history/ajax.png"></div>
                        <p class="description">XMLHttpRequest</p>
                    </td>
                    <td class="top">
                        <div class="year text-purple">2001</div>
                    </td>
                    <td class="top">
                        <div class="connector"></div>
                        <div class="icon-circle blue"><img src="assets/history/spa.png">
                        </div>
                        <p class="description">SPA</p>
                    </td>
                </tr>
            </table>
            <aside class="notes">Kompozycja stron na podstawie json a nie html</aside>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-2">
            <h1 class="r-fit-text">Second riddle</h1>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-2">
            <h1>Second riddle</h1>
            <h3>Which company created the iframe</h3>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-2">
            <h1>Second riddle</h1>
            <h3>Which company created the iframe</h3>
            <p>Hint: Don't let the name fool you, it wasn't Apple</p>
        </section>
        <section data-auto-animate data-auto-animate-id="riddle-2">
            <h1>Microsoft</h1>
            <p>The <span class="red">&lt;iframe&gt;</span> element was introduced by Microsoft in 1997 as part of
                Internet Explorer 3.0. It officially became part of the HTML 4.0 standard, which was approved by the W3C
                (World Wide Web Consortium) in December 1997.</p>
            <aside class="notes">Iframe nadal chętnie jest używany do osadzania kontentu np: filmy z youtube na własnej stronie</aside>
        </section>
        <section>
            <h1 class="r-fit-text">Technology Overview</h1>
        </section>
        <section>
            <h3>Technology Overview</h3>
            <p style="font-size: smaller;">Page composition can be categorized into four types based on where the
                assembly occurs: backend
                composition, server-side composition, edge-side composition, and client-side composition. Each approach
                determines where and how different components are combined to render the final webpage, impacting
                performance, flexibility, and caching strategies.</p>
            <img class="stretch" src="assets/technology.png">
            <aside class="notes">
                <ul>
                    <li>W prezentacji zajmiemy się wyłącznie dwoma środkowymi kolumnami</li>
                    <li>Jednak zanim to zrobimy omówimy szybko dwa pozostałe</li>
                </ul>
            </aside>
        </section>
        <section>
            <h3>Technology Overview - backend composition</h3>
            <div style="font-size: smaller;">✅ Pros:
                <ul>
                    <li><strong>Easy Implementation</strong> – Simple to develop and maintain within a monolithic
                        backend.
                    </li>
                    <li><strong>Strong Integration</strong> – Direct access to databases and business logic.</li>
                </ul>
            </div>
            <div class="fragment" style="font-size: smaller;">❌ Cons:
                <ul>
                    <li><strong>Caching Challenges</strong> – Difficult to cache dynamic content efficiently.</li>
                    <li><strong>Performance Issues</strong> – Most web languages are single-threaded, potentially
                        causing bottlenecks.
                    </li>
                    <li><strong>Monolithic Architecture</strong> – Encourages tightly coupled systems, reducing
                        flexibility and
                        scalability.
                    </li>
                </ul>
            </div>
        </section>
        <section>
            <h3>Technology Overview - client side</h3>
            <div style="font-size: 0.7em;">✅ Pros:
                <ul>
                    <li><strong>Lazy Loading</strong> – Loads only the necessary components, improving performance and
                        user experience.
                    </li>
                    <li><strong>Frontend Rendering</strong> – Moves HTML generation from server to client, reducing
                        backend complexity.
                    </li>
                    <li><strong>Flexible and Scalable</strong> – Works well with microservices and APIs, allowing
                        independent frontend updates.
                    </li>
                </ul>
            </div>
            <div class="fragment" style="font-size: 0.7em;">❌ Cons:
                <ul>
                    <li><strong>Slower Initial Load</strong> – More processing happens in the browser, which may delay
                        rendering.
                    </li>
                    <li><strong>SEO Challenges</strong> – Search engines may struggle to index client-rendered content
                        without proper server-side support.
                    </li>
                    <li><strong>Inconsistent Performance</strong> – Heavily depends on the user’s device and network
                        speed.
                    </li>
                </ul>
            </div>
        </section>
        <section>
            <h1>Server Side Include (SSI)</h1>
        </section>
        <section>
            <h3>Server Side Include (SSI)</h3>
            <p>
                Server Side Includes (SSI) is a server-side feature that allows web pages to include content from other sources before being sent to the client.
                It works by processing special SSI directives, such as:<pre><code><!--# include file="header.html" --></code></pre>
                which enable the inclusion of external files or subrequests.
                It is supported by Apache, LiteSpeed, Nginx and IIS servers
            </p>
        </section>
        <section>
            <h3>Apache SSI</h3>
            <div>
                <p>In Apache, configuring Server Side Includes (SSI) is straightforward because the mod_include module is compiled by default and only needs to be activated.</p>
                <strong>Enable:</strong>
                <pre><code>a2enmod include</code></pre>
                <strong>Config</strong>:
                <pre>
<code>Options +Includes
AddOutputFilter INCLUDES .php .shtml .html
</code></pre>
            </div>
        </section>
        <section>
            <h3>Nginx SSI</h3>
            <div>
                <p>In Nginx, configuring Server Side Includes (SSI) can be more complex because the ngx_http_ssi_module is not compiled by default on some distributions and may need to be enabled during the build process.</p>
                <strong>Enable:</strong>
                <pre><code>./configure --with-http_ssi_module</code></pre>
                <strong>Config</strong>:
                <pre>
<code>location / {
    ssi on;
}
</code></pre>
            </div>
            <aside class="notes">
                <ul>
                    <li>Na szczęście w nowych wersjach alpine linux nginx jest skompilowany z tym modułem</li>
                    <li>W dalszej częsci wszystko co omówie dotyczy ssi dla nginx</li>
                </ul>
            </aside>
        </section>
        <section>
            <h2>Basic usage</h2>
            <div>
                <p>Include file:</p>
                <pre><code data-trim class="language-html">
&lt;body&gt;
    &lt;!--# include file="header.html" --&gt;
    &lt;!--# include file="content.html" --&gt;
    &lt;!--# include file="footer.html" --&gt;
&lt;/body&gt;
            </code></pre>
            </div>
            <div class="fragment">
                <p>Include request:</p>
                <pre><code data-trim class="language-html">
&lt;body&gt;
    &lt;!--# include virtual="/_component/v1/header" --&gt;
    &lt;!--# include virtual="/_component/v1/content" --&gt;
    &lt;!--# include virtual="/_component/v1/footer" --&gt;
&lt;/body&gt;
            </code></pre>
            </div>
        </section>
        <section>
            <h1 class="r-fit-text">Demo time</h1>
        </section>
        <section>
            <h1>Try yourself</h1>
            <p>You can run demo by pulling docker container</p>
            <pre><code>docker run -p 8888:80 crazygoat/nginx-ssi-example</code></pre>
            <p>And visit</p>
            <pre><code>http://127.0.0.1:8888/</code></pre>
        </section>
        <section data-auto-animate="demo-1">
            <h2>Original code</h2>
            <pre><code  data-id="code-animation" style="font-size: 0.9em"><header><?php include "_component/header.php" ?></header>
<div class="container">
    <nav class="left-menu"><?php include "_component/left_menu.php" ?></nav>
    <div class="content-area">
        <div class="breadcrumbs"><?php include "_component/breadcrumbs.php" ?></div>
        <div class="content">
            <div class="content1"><?php include "_component/content.php" ?></div>
            ...
        </div>
    </div>
</div>
<footer><?php include "_component/footer.php" ?></footer></code></pre>
        </section>
        <section data-auto-animate="demo-1">
            <h2>SSI code</h2>
            <pre><code  data-id="code-animation" style="font-size: 0.9em"><header><!--# include virtual="/_component/header.php" --></header>
<div class="container">
    <nav class="left-menu"><!--# include virtual="/_component/left_menu.php" --></nav>
    <div class="content-area">
        <div class="breadcrumbs"><!--# include virtual="/_component/breadcrumbs.php" --></div>
        <div class="content">
            <div class="content1"><!--# include virtual="/_component/content.php" --></div>
            ...
        </div>
    </div>
</div>
<footer><!--# include virtual="/_component/footer.php" --></footer></code></pre>
        </section>
        <section>
            <h2>Component code</h2>
            <p>_component/breadcrumbs.php</p>
            <pre><code>&lt;?php usleep(100000); echo "Breadcrumbs";</code></pre>
        </section>
        <section>
            <h2>nginx config</h2>
            <pre><code>server {
    ...
    ssi on;

    location ~ \.php$ {
        fastcgi_pass   php_fpm;
        fastcgi_param  SCRIPT_FILENAME /var/www/$fastcgi_script_name;
        include        fastcgi_params;
    }
}</code></pre>
        </section>
        <section>
            <h2>nginx config - cache</h2>
            Nginx configuration:
            <pre ><code style="font-size: 0.8em;">fastcgi_cache_path /tmp/nginx-cache levels=1 keys_zone=articles_cache:10m max_size=1024m inactive=1h;

location ~/_component/*\.php$ {
    fastcgi_cache_key $scheme$host$uri$request_method;
    fastcgi_cache articles_cache;
}</code>
            </pre>
            Cache ttl is controlled by Cache-Control Header:
            <pre><code>header("Cache-Control: public, max-age=10");</code>
            </pre>
            <strong>Important!</strong> only public cache is stored
        </section>
        <section>
            <h3>Important limitations</h3>
            <ul>
                <li>All parameters to the component must be passed in the query string</li>
                <li class="fragment">By default, headers from the main request are not passed</li>
                <li class="fragment">Better prepare a looooot of PHP workers</li>
                <li class="fragment">SSI requests can only be performed within the server*</li>
                <li class="fragment">Using session can be problematic (session lock)</li>
            </ul>
            <aside class="notes">*W przypadku nginx można te limitacje ominąć</aside>
        </section>
        <section>
            <h3>Important limitations - remote requests</h3>
            <p></p>
            <pre><code>upstream components_backend {
    server app1.server.internal:80;
    server app2.server.internal:80;
    ...
}

server {
    location /_components/ {
        proxy_pass http://components_backend;
        proxy_set_header Host $host;
        ...
     }
}</code></pre>
        </section>
        <section>
            <h3>Technology Overview - server side composition</h3>
            <div style="font-size: 0.7em;">✅ Pros:
                <ul>
                    <li><strong>Improved Performance</strong> – Enables partial page caching, reducing backend load.
                    </li>
                    <li><strong>Efficient Content Assembly</strong> – Components are fetched in parallel, speeding up
                        page rendering.
                    </li>
                    <li><strong>Multi-Language Support</strong> – Components can be written in different programming
                        languages and integrated seamlessly.
                    </li>
                </ul>
            </div>
            <div class="fragment" style="font-size: 0.7em;">❌ Cons:
                <ul>
                    <li><strong>Limited Flexibility</strong> – Requires server-side support and specific configurations.
                    </li>
                    <li><strong>Increased Complexity</strong> – Managing dependencies between fragments can be
                        challenging.
                    </li>
                    <li><strong>Security Risks</strong> – Incorrect configuration may introduce vulnerabilities, such as
                        exposing internal services or enabling injection attacks.
                    </li>
                    <li><strong>Other challenges</strong> – timeouts, loops, error handling.
                    </li>
                </ul>
            </div>
        </section>
        <section><h1>Edge Side Include (ESI)</h1></section>
        <section>
            <h3>Edge Side Include (ESI)</h3>
            <p>
                Edge Side Includes (ESI) is a CDN feature that allows web pages to include content from other sources before being sent to the client.
                It works by processing special ESI directives, such as:<pre><code>&lt;esi:include src="http://foo.bar/components/foo" /&gt;</code></pre>
            which enable the inclusion of external subrequests.
            </p>
        </section>
        <section>
            <h3>ESI support</h3>
            <div>
                <h4>CDNs</h4>
                <ul>
                    <li><strong>Akamai</strong> - The original creator of ESI and provides full support.</li>
                    <li><strong>Fastly</strong> - Strong ESI support, Varnish-based.</li>
                    <li><strong>CloudFlare</strong> - Offers ESI through their Workers platform.</li>
                    <li><strong>AWS CloudFront</strong> - Limited ESI support through Lambda@Edge functions.</li>
                </ul>
            </div>
        </section>
        <section>
            <h3>ESI support</h3>
            <div>
                <h4>Cache</h4>
                <ul>
                    <li><strong>Varnish Cache</strong> - Robust ESI implementation including tags</li>
                    <li><strong>Squid Cache</strong> - Basic ESI functionality includes</li>
                </ul>
            </div>
        </section>
        <section>
            <h3>ESI support</h3>
            <div>
                <h4>Proxy & application servers</h4>
                <ul>
                    <li><strong>Traefik</strong> - via go-esi plugin</li>
                    <li><strong>Caddy</strong> - via go-esi plugin</li>
                    <li><strong>Roadrunner</strong> - via go-esi plugin</li>
                </ul>
            </div>
        </section>
        <section>
            <h2>Basic usage</h2>
            <div>
                <p>Include request:</p>
                <pre><code data-trim class="language-html">
&lt;body&gt;
    &lt;esi:include src="http://example.com/_component/v1/header" /&gt;
    &lt;esi:include src="http://example.com/_component/v1/content" /&gt;
    &lt;esi:include src="http://example.com/_component/v1/footer" /&gt;
&lt;/body&gt;
            </code></pre>
            </div>
        </section>
        <section>
            <h2>Basic Error Handling</h2>
            Simple fallback with alt attributes:
            <pre><code>&lt;esi:include src="http://example.com/_component/v2/header"
             alt="http://example.com/_component/v1/header" /&gt;</code></pre>
            <p>If <code class="highlight-code">/v2/header</code> fails, then load <code class="highlight-code">/v1/header</code>. Great for quick fallback.</p>
        </section>
        <section>
            <h2>Advanced Fallback</h2>
            Advanced fallback with <code class="highlight-code">&lt;esi:try&gt;</code> tag:
            <pre><code style="font-size: 0.8em"><esi:try>
  <esi:attempt>
    <esi:include src="http://example.com/_component/v2/header" />
  </esi:attempt>
  <esi:except>
    <div hx-get="http://example.com/_component/v1/header"

         hx-trigger="load" hx-swap="outerHTML">
      Loading guest box...
    </div>
  </esi:except>
</esi:try>
</code></pre>
            <p>If <code class="highlight-code">/v2/header</code> fails, then load <code class="highlight-code">/v1/header</code> using htmx</p>
        </section>
        <section>
            <h2>Detecting ESI Support</h2>
            <p>Most CDN providers add special HTTP headers to let you know ESI is available and active. Most popular is <code class="highlight-code">Surrogate-Control</code>, example:</p>
            <pre><code>Surrogate-Control: content="ESI/1.0"</code></pre>
        </section>
        <section>
            <h2>Notifying CDN about ESI content</h2>
            <p>Parsing server responses for esi tags can be demanding. That's why most CDNs only parse responses that have the <code class="highlight-code">Edge-Control</code> header set. Example:</p>
            <pre><code>Edge-control: dca=esi</code></pre>
        </section>
        <section>
            <h1 class="r-fit-text">Demo time</h1>
        </section>
        <section>
            <h3>Technology Overview - edge side composition</h3>
            <div style="font-size: 0.7em;">✅ Pros:
                <ul>
                    <li><strong>Reduced Backend Load</strong> – Pages are partially assembled at the CDN level, reducing
                        server strain.
                    </li>
                    <li><strong>Faster Content Delivery</strong> – Components can be cached closer to the user,
                        improving response times.
                    </li>
                    <li><strong>Easy to Configure</strong> – Many CDNs offer built-in ESI support with minimal setup
                        required.
                    </li>
                </ul>
            </div>
            <div class="fragment" style="font-size: 0.7em;">❌ Cons:
                <ul>
                    <li><strong>Limited cache invalidation</strong> – Can be hard to invalid single cache item.
                    </li>
                    <li><strong>Complex Debugging</strong> – Issues may be harder to trace due to processing happening
                        at the edge.
                    </li>
                    <li><strong>CDN Dependency</strong> – Requires a CDN with ESI support, limiting flexibility in
                        infrastructure choices.
                    </li>
                    <li><strong>Additional Costs</strong> – CDN services with ESI support can come with extra fees.</li>
                </ul>
            </div>
        </section>
    </div>
</div>

<script src="/dist/reveal.js"></script>
<script src="/plugin/notes/notes.js"></script>
<script src="/plugin/markdown/markdown.js"></script>
<script src="/plugin/highlight/highlight.js"></script>
<script>
    Reveal.initialize({
        width: 1280,
        hash: true,
        slideNumber: 'c/t',
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
</script>
</body>
</html>